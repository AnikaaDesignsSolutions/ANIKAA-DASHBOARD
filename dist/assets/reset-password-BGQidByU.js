import{u as b,w as N,W as S,r as l,cS as v,j as e,B as E}from"./index-JPne9CEF.js";import{a as P,M as R}from"./index.esm-duCv3Qe7.js";import{d as k}from"./index.modern-CpgaMXyi.js";import{L as M,S as o}from"./login-layout-BzR57Q1T.js";import{S as _}from"./index-B7WhEIZx.js";import{g as C}from"./error-messages-DhbYeD1Z.js";import"./index-qr1gExzI.js";const z=()=>{const u=b(),p=N(),s=S.parse(p.search.substring(1));let r=null;if(s!=null&&s.token)try{r=k(s.token)}catch{r=null}const[x,n]=l.useState(!1),[w,i]=l.useState(null),[f,d]=l.useState(!1),m=(r==null?void 0:r.email)||(s==null?void 0:s.email)||"",{register:c,handleSubmit:g,formState:a}=P({defaultValues:{password:"",repeat_password:""}}),h=v(),y=t=>{if(n(!1),i(null),t.password!==t.repeat_password){n(!0);return}h.mutate({token:s.token,password:t.password,email:m},{onSuccess:()=>{u("/login")},onError:j=>{i(C(j))}})};return l.useEffect(()=>{a.dirtyFields.password&&a.dirtyFields.repeat_password?d(!0):d(!1)},[a]),e.jsxs(M,{children:[e.jsx(_,{title:"Reset Password"}),e.jsx("div",{className:"flex h-full w-full items-center justify-center",children:e.jsx("div",{className:"flex min-h-[540px] bg-grey-0 rounded-rounded justify-center",children:e.jsxs("form",{className:"flex flex-col py-12 w-full px-[120px] items-center",onSubmit:g(y),children:[e.jsx(R,{}),r?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"inter-2xlarge-semibold mt-4 text-grey-90",children:"Reset your password"}),e.jsx("span",{className:"inter-base-regular text-grey-50 mt-2 mb-xlarge",children:"Choose a new password below üëáüèº"}),e.jsx(o,{placeholder:"Email",name:"first_name",value:m,readOnly:!0}),e.jsx(o,{placeholder:"Password",type:"password",...c("password",{required:!0}),autoComplete:"new-password"}),e.jsx(o,{placeholder:"Confirm password",type:"password",...c("repeat_password",{required:!0}),autoComplete:"new-password",className:"mb-0"}),w&&e.jsx("span",{className:"text-rose-50 w-full mt-xsmall inter-small-regular",children:"The two passwords are not the same"}),x&&e.jsx("span",{className:"text-rose-50 w-full mt-xsmall inter-small-regular",children:"The two passwords are not the same"}),e.jsx(E,{variant:"primary",size:"large",type:"submit",className:"w-full mt-base rounded-rounded",loading:a.isSubmitting,disabled:!f,children:"Reset Password"})]}):e.jsxs("div",{className:"h-full flex flex-col gap-y-2 text-center items-center justify-center",children:[e.jsx("span",{className:"inter-large-semibold text-grey-90",children:"You reset link is invalid"}),e.jsx("span",{className:"inter-base-regular text-grey-50 mt-2",children:"Please try resetting your password again"})]})]})})})]})};export{z as default};
